(()=>{var e={};e.id=356,e.ids=[356],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},63477:e=>{"use strict";e.exports=require("querystring")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},87529:()=>{},28665:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{POST:()=>c});var i=r(49303),n=r(88716),a=r(60670),o=r(19893),u=r(49758),p=r(64099);async function c(e){try{let{user:t}=await (0,p.getSession)(e);if(!t)return new Response(JSON.stringify({error:"No authenticated user found"}),{status:401});if(await (0,o.P)(),!await u.Z.findOne({auth0Id:t.sub})){let e=new u.Z({auth0Id:t.sub,email:t.email,username:t.nickname,image:t.picture}),r=await e.save();return new Response(JSON.stringify({message:"User added to the database",user:r}),{status:201,headers:{"Content-Type":"application/json"}})}return new Response(JSON.stringify({message:"User already exists in the database"}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("An error occurred:",e),new Response(JSON.stringify({error:"An error occurred while adding the user to the database"}),{status:500,headers:{"Content-Type":"application/json"}})}}let d=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/user/route",pathname:"/api/user",filename:"route",bundlePath:"app/api/user/route"},resolvedPagePath:"C:\\Room\\Next js\\share_prompts\\app\\api\\user\\route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:g}=d,x="/api/user/route";function h(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},49758:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(11185);let i=new s.Schema({auth0Id:{type:String,required:!0,unique:!0},email:{type:String,unique:[!0,"Email already exist"],required:[!0,"Email is required"]},username:{type:String,required:[!0,"Username is required"],match:[/^(?=.{8,20}$)(?![_.])(?!.*[_.]{2})[a-zA-Z0-9._]+(?<![_.])$/,"Username invalid, it should contain 8-20 alphanumeric letters and be unique!"]},image:{type:String}}),n=s.models?.User||(0,s.model)("User",i)},19893:(e,t,r)=>{"use strict";r.d(t,{P:()=>n});var s=r(11185),i=r.n(s);let n=async()=>{i().connect("mongodb+srv://nourkhansa7:1RXm9gw4gBOhiPgT@protopia.kurwnz6.mongodb.net/?retryWrites=true&w=majority&appName=protopia").then(()=>console.log("Connected to DB")).catch(e=>console.log(e))}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,463,99],()=>r(28665));module.exports=s})();